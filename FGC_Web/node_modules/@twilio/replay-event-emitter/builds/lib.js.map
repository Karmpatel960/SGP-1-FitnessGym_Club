{"version":3,"file":"lib.js","sources":["../src/replay-event-emitter.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\n\nimport { EventEmitter } from \"events\";\n\nexport class ReplayEventEmitter<\n  Events extends Record<string | symbol, (...args: any[]) => void>\n> extends EventEmitter {\n  private eventHistory: Map<string | symbol, any[]> = new Map();\n\n  public constructor() {\n    super();\n  }\n\n  public on<E extends Extract<keyof Events, string>>(\n    event: E,\n    listener: Events[E]\n  ): this {\n    return super.on(event, listener);\n  }\n\n  public once<E extends Extract<keyof Events, string>>(\n    event: E,\n    listener: Events[E]\n  ): this {\n    return super.once(event, listener);\n  }\n\n  public off<E extends Extract<keyof Events, string>>(\n    event: E,\n    listener: Events[E]\n  ): this {\n    return super.off(event, listener);\n  }\n\n  public emit<E extends Extract<keyof Events, string>>(\n    event: E,\n    ...args: Parameters<Events[E]>\n  ): boolean {\n    this.eventHistory.set(event, args);\n\n    return super.emit(event, ...args);\n  }\n\n  public addListener<E extends Extract<keyof Events, string>>(\n    event: E,\n    listener: Events[E]\n  ): this {\n    return super.addListener(event, listener);\n  }\n\n  public removeListener<E extends Extract<keyof Events, string>>(\n    event: E,\n    listener: Events[E]\n  ): this {\n    return super.removeListener(event, listener);\n  }\n\n  public addListenerWithReplay<E extends Extract<keyof Events, string>>(\n    event: E,\n    listener: Events[E]\n  ): this {\n    const historyEntry = this.eventHistory.get(event);\n\n    if (historyEntry !== undefined) {\n      listener(...historyEntry);\n    }\n\n    return this.addListener(event, listener);\n  }\n\n  public onWithReplay<E extends Extract<keyof Events, string>>(\n    event: E,\n    listener: Events[E]\n  ): this {\n    return this.addListenerWithReplay(event, listener);\n  }\n}\n"],"names":["EventEmitter"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAIa,kBAAb;AAAA;;AAAA;;AAKE,gCAAA;AAAA;;AAAA;;AACE;;AADF,2GAFoD,IAAI,GAAJ,EAEpD;;AAAA;AAEC;;AAPH;AAAA;AAAA,WASS,YACL,KADK,EAEL,QAFK,EAEc;AAEnB,gIAAgB,KAAhB,EAAuB,QAAvB;AACD;AAdH;AAAA;AAAA,WAgBS,cACL,KADK,EAEL,QAFK,EAEc;AAEnB,kIAAkB,KAAlB,EAAyB,QAAzB;AACD;AArBH;AAAA;AAAA,WAuBS,aACL,KADK,EAEL,QAFK,EAEc;AAEnB,iIAAiB,KAAjB,EAAwB,QAAxB;AACD;AA5BH;AAAA;AAAA,WA8BS,cACL,KADK,EAEyB;AAAA;;AAAA,wCAA3B,IAA2B;AAA3B,QAAA,IAA2B;AAAA;;AAE9B,WAAK,YAAL,CAAkB,GAAlB,CAAsB,KAAtB,EAA6B,IAA7B;AAEA,0JAAkB,KAAlB,SAA4B,IAA5B;AACD;AArCH;AAAA;AAAA,WAuCS,qBACL,KADK,EAEL,QAFK,EAEc;AAEnB,yIAAyB,KAAzB,EAAgC,QAAhC;AACD;AA5CH;AAAA;AAAA,WA8CS,wBACL,KADK,EAEL,QAFK,EAEc;AAEnB,4IAA4B,KAA5B,EAAmC,QAAnC;AACD;AAnDH;AAAA;AAAA,WAqDS,+BACL,KADK,EAEL,QAFK,EAEc;AAEnB,UAAM,YAAY,GAAG,KAAK,YAAL,CAAkB,GAAlB,CAAsB,KAAtB,CAArB;;AAEA,UAAI,YAAY,KAAK,SAArB,EAAgC;AAC9B,QAAA,QAAQ,MAAR,gDAAY,YAAZ;AACD;;AAED,aAAO,KAAK,WAAL,CAAiB,KAAjB,EAAwB,QAAxB,CAAP;AACD;AAhEH;AAAA;AAAA,WAkES,sBACL,KADK,EAEL,QAFK,EAEc;AAEnB,aAAO,KAAK,qBAAL,CAA2B,KAA3B,EAAkC,QAAlC,CAAP;AACD;AAvEH;;AAAA;AAAA,EAEUA,mBAFV;;"}