{"version":3,"file":"closeable.js","sources":["../src/closeable.ts"],"sourcesContent":["import { v4 as uuidv4 } from 'uuid';\nimport { ReplayEventEmitter } from '@twilio/replay-event-emitter';\nimport SyncError from './utils/syncerror';\nimport { SubscriptionState } from './entity';\nimport { InsightsItem } from './livequery';\nimport { SyncStreamMessage } from './streams/syncstream';\n\nexport type CloseableEvents = {\n  updated: (eventData: {data: any, previousData: any, isLocal: boolean}) => void;\n  removed: (eventData: {previousData?: any, isLocal: boolean}) => void;\n  itemUpdated: (eventData: any) => void;\n  itemAdded: (eventData: any) => void;\n  itemRemoved: (eventData: any) => void;\n  contextUpdated: (eventData: {context: any, isLocal: boolean}) => void,\n  messagePublished: (eventData: {message: SyncStreamMessage, isLocal: boolean}) => void,\n  failure: (error: SyncError) => void,\n  _subscriptionStateChanged: (state: SubscriptionState) => void\n};\n\nabstract class Closeable extends ReplayEventEmitter<CloseableEvents> {\n\n  private readonly uuid: string;\n  private closed: boolean;\n\n  constructor() {\n    super();\n    this.closed = false;\n    this.uuid = uuidv4();\n  }\n\n  get listenerUuid(): string {\n    return this.uuid;\n  }\n\n  protected close() {\n    this.removeAllListeners();\n    this.closed = true;\n  }\n\n  protected ensureNotClosed() {\n    if (this.closed) {\n      throw new Error('Invalid operation on closed object');\n    }\n  }\n\n}\nexport { Closeable };\nexport default Closeable;"],"names":["ReplayEventEmitter","uuidv4"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmBA,MAAe,SAAU,SAAQA,qCAAmC,CAAA;AAKlE,IAAA,WAAA,GAAA;AACE,QAAA,KAAK,EAAE,CAAC;AACR,QAAA,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;AACpB,QAAA,IAAI,CAAC,IAAI,GAAGC,OAAM,EAAE,CAAC;KACtB;AAED,IAAA,IAAI,YAAY,GAAA;QACd,OAAO,IAAI,CAAC,IAAI,CAAC;KAClB;IAES,KAAK,GAAA;QACb,IAAI,CAAC,kBAAkB,EAAE,CAAC;AAC1B,QAAA,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;KACpB;IAES,eAAe,GAAA;QACvB,IAAI,IAAI,CAAC,MAAM,EAAE;AACf,YAAA,MAAM,IAAI,KAAK,CAAC,oCAAoC,CAAC,CAAC;AACvD,SAAA;KACF;AAEF;;;;;"}