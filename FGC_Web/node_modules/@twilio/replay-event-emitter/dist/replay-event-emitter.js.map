{"version":3,"file":"replay-event-emitter.js","sources":["../src/replay-event-emitter.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\n\nimport { EventEmitter } from \"events\";\n\nexport class ReplayEventEmitter<\n  Events extends Record<string | symbol, (...args: any[]) => void>\n> extends EventEmitter {\n  private eventHistory: Map<string | symbol, any[]> = new Map();\n\n  public constructor() {\n    super();\n  }\n\n  public on<E extends Extract<keyof Events, string>>(\n    event: E,\n    listener: Events[E]\n  ): this {\n    return super.on(event, listener);\n  }\n\n  public once<E extends Extract<keyof Events, string>>(\n    event: E,\n    listener: Events[E]\n  ): this {\n    return super.once(event, listener);\n  }\n\n  public off<E extends Extract<keyof Events, string>>(\n    event: E,\n    listener: Events[E]\n  ): this {\n    return super.off(event, listener);\n  }\n\n  public emit<E extends Extract<keyof Events, string>>(\n    event: E,\n    ...args: Parameters<Events[E]>\n  ): boolean {\n    this.eventHistory.set(event, args);\n\n    return super.emit(event, ...args);\n  }\n\n  public addListener<E extends Extract<keyof Events, string>>(\n    event: E,\n    listener: Events[E]\n  ): this {\n    return super.addListener(event, listener);\n  }\n\n  public removeListener<E extends Extract<keyof Events, string>>(\n    event: E,\n    listener: Events[E]\n  ): this {\n    return super.removeListener(event, listener);\n  }\n\n  public addListenerWithReplay<E extends Extract<keyof Events, string>>(\n    event: E,\n    listener: Events[E]\n  ): this {\n    const historyEntry = this.eventHistory.get(event);\n\n    if (historyEntry !== undefined) {\n      listener(...historyEntry);\n    }\n\n    return this.addListener(event, listener);\n  }\n\n  public onWithReplay<E extends Extract<keyof Events, string>>(\n    event: E,\n    listener: Events[E]\n  ): this {\n    return this.addListenerWithReplay(event, listener);\n  }\n}\n"],"names":["__extends","EventEmitter"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;;IAMUA,gDAAY;IAGpB;QAAA,YACE,iBAAO,SACR;QAJO,kBAAY,GAAgC,IAAI,GAAG,EAAE,CAAC;;KAI7D;IAEM,+BAAE,GAAT,UACE,KAAQ,EACR,QAAmB;QAEnB,OAAO,iBAAM,EAAE,YAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;KAClC;IAEM,iCAAI,GAAX,UACE,KAAQ,EACR,QAAmB;QAEnB,OAAO,iBAAM,IAAI,YAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;KACpC;IAEM,gCAAG,GAAV,UACE,KAAQ,EACR,QAAmB;QAEnB,OAAO,iBAAM,GAAG,YAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;KACnC;IAEM,iCAAI,GAAX,UACE,KAAQ;QACR,cAA8B;aAA9B,UAA8B,EAA9B,qBAA8B,EAA9B,IAA8B;YAA9B,6BAA8B;;QAE9B,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;QAEnC,OAAO,iBAAM,IAAI,sCAAC,KAAK,GAAK,IAAI,GAAE;KACnC;IAEM,wCAAW,GAAlB,UACE,KAAQ,EACR,QAAmB;QAEnB,OAAO,iBAAM,WAAW,YAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;KAC3C;IAEM,2CAAc,GAArB,UACE,KAAQ,EACR,QAAmB;QAEnB,OAAO,iBAAM,cAAc,YAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;KAC9C;IAEM,kDAAqB,GAA5B,UACE,KAAQ,EACR,QAAmB;QAEnB,IAAM,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;QAElD,IAAI,YAAY,KAAK,SAAS,EAAE;YAC9B,QAAQ,eAAI,YAAY,EAAE;SAC3B;QAED,OAAO,IAAI,CAAC,WAAW,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;KAC1C;IAEM,yCAAY,GAAnB,UACE,KAAQ,EACR,QAAmB;QAEnB,OAAO,IAAI,CAAC,qBAAqB,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;KACpD;IACH,yBAAC;AAAD,CAxEA,CAEUC,+BAAY;;;;"}