{"version":3,"file":"replay-event-emitter.js","sources":["../src/replay-event-emitter.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\n\nimport { EventEmitter } from \"events\";\n\nexport class ReplayEventEmitter<\n  Events extends Record<string | symbol, (...args: any[]) => void>\n> extends EventEmitter {\n  private eventHistory: Map<string | symbol, any[]> = new Map();\n\n  public constructor() {\n    super();\n  }\n\n  public on<E extends Extract<keyof Events, string>>(\n    event: E,\n    listener: Events[E]\n  ): this {\n    return super.on(event, listener);\n  }\n\n  public once<E extends Extract<keyof Events, string>>(\n    event: E,\n    listener: Events[E]\n  ): this {\n    return super.once(event, listener);\n  }\n\n  public off<E extends Extract<keyof Events, string>>(\n    event: E,\n    listener: Events[E]\n  ): this {\n    return super.off(event, listener);\n  }\n\n  public emit<E extends Extract<keyof Events, string>>(\n    event: E,\n    ...args: Parameters<Events[E]>\n  ): boolean {\n    this.eventHistory.set(event, args);\n\n    return super.emit(event, ...args);\n  }\n\n  public addListener<E extends Extract<keyof Events, string>>(\n    event: E,\n    listener: Events[E]\n  ): this {\n    return super.addListener(event, listener);\n  }\n\n  public removeListener<E extends Extract<keyof Events, string>>(\n    event: E,\n    listener: Events[E]\n  ): this {\n    return super.removeListener(event, listener);\n  }\n\n  public addListenerWithReplay<E extends Extract<keyof Events, string>>(\n    event: E,\n    listener: Events[E]\n  ): this {\n    const historyEntry = this.eventHistory.get(event);\n\n    if (historyEntry !== undefined) {\n      listener(...historyEntry);\n    }\n\n    return this.addListener(event, listener);\n  }\n\n  public onWithReplay<E extends Extract<keyof Events, string>>(\n    event: E,\n    listener: Events[E]\n  ): this {\n    return this.addListenerWithReplay(event, listener);\n  }\n\n  public onceWithReplay<E extends Extract<keyof Events, string>>(\n    event: E,\n    listener: Events[E]\n  ): this {\n    const historyEntry = this.eventHistory.get(event);\n\n    if (historyEntry !== undefined) {\n      listener(...historyEntry);\n      return this;\n    }\n\n    return super.once(event, listener);\n  }\n}\n"],"names":["__extends","__spreadArray","EventEmitter"],"mappings":"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"}